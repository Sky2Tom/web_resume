<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>æµ‹è¯•åšå®¢æ˜¾ç¤º</title>
    <style>
        body {
            font-family: monospace;
            padding: 20px;
            background: #f5f5f5;
        }
        .container {
            background: white;
            padding: 20px;
            border-radius: 8px;
            max-width: 1200px;
            margin: 0 auto;
        }
        button {
            background: #0066FF;
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 4px;
            cursor: pointer;
            margin: 10px 5px;
        }
        pre {
            background: #f9f9f9;
            padding: 15px;
            border-radius: 4px;
            overflow-x: auto;
            border: 1px solid #ddd;
            max-height: 400px;
            overflow-y: auto;
        }
        .success { color: green; font-weight: bold; }
        .error { color: red; font-weight: bold; }
        .info { color: blue; }
    </style>
</head>
<body>
    <div class="container">
        <h1>ğŸ” æµ‹è¯•åšå®¢æ˜¾ç¤ºåŠŸèƒ½</h1>
        <button onclick="testAPI()">1. æµ‹è¯• API</button>
        <button onclick="testDisplay()">2. æµ‹è¯•æ˜¾ç¤º</button>
        <button onclick="testElement()">3. æ£€æŸ¥å…ƒç´ </button>
        <button onclick="runAll()">è¿è¡Œæ‰€æœ‰æµ‹è¯•</button>
        <div id="result"></div>
    </div>
    
    <script>
        let testData = null;
        
        async function testAPI() {
            const resultDiv = document.getElementById('result');
            resultDiv.innerHTML = '<h2>æµ‹è¯• 1: API è¿æ¥</h2><pre>æ­£åœ¨æµ‹è¯•...</pre>';
            
            try {
                const response = await fetch('/api/blogs');
                const data = await response.json();
                testData = data;
                
                resultDiv.innerHTML = `
                    <h2 class="success">âœ… æµ‹è¯• 1: API è¿æ¥æˆåŠŸ</h2>
                    <pre>${JSON.stringify(data, null, 2)}</pre>
                    <p class="success">åšå®¢æ•°é‡: ${data.blogs?.length || 0}</p>
                `;
            } catch (error) {
                resultDiv.innerHTML = `
                    <h2 class="error">âŒ æµ‹è¯• 1: API è¿æ¥å¤±è´¥</h2>
                    <pre>${error.message}</pre>
                `;
            }
        }
        
        function testElement() {
            const resultDiv = document.getElementById('result');
            resultDiv.innerHTML = '<h2>æµ‹è¯• 3: æ£€æŸ¥ DOM å…ƒç´ </h2><pre>æ­£åœ¨æ£€æŸ¥...</pre>';
            
            // æ£€æŸ¥ä¸»é¡µé¢ä¸­çš„ blogList å…ƒç´ 
            const blogList = document.getElementById('blogList');
            
            if (blogList) {
                resultDiv.innerHTML = `
                    <h2 class="success">âœ… æµ‹è¯• 3: blogList å…ƒç´ å­˜åœ¨</h2>
                    <pre>å…ƒç´ : ${blogList.outerHTML.substring(0, 200)}...</pre>
                    <p>çˆ¶å…ƒç´ : ${blogList.parentElement?.tagName || 'N/A'}</p>
                    <p>å½“å‰å†…å®¹é•¿åº¦: ${blogList.innerHTML.length} å­—ç¬¦</p>
                `;
            } else {
                resultDiv.innerHTML = `
                    <h2 class="error">âŒ æµ‹è¯• 3: blogList å…ƒç´ ä¸å­˜åœ¨</h2>
                    <p>è¯·æ£€æŸ¥ index.html ä¸­æ˜¯å¦æœ‰ &lt;div id="blogList"&gt;&lt;/div&gt;</p>
                    <p>æ³¨æ„ï¼šè¿™ä¸ªæµ‹è¯•é¡µé¢ä¸­å¯èƒ½æ²¡æœ‰ blogList å…ƒç´ ï¼Œè¿™æ˜¯æ­£å¸¸çš„ã€‚</p>
                `;
            }
        }
        
        function testDisplay() {
            const resultDiv = document.getElementById('result');
            
            if (!testData) {
                resultDiv.innerHTML = '<h2 class="error">âŒ è¯·å…ˆè¿è¡Œ"æµ‹è¯• API"</h2>';
                return;
            }
            
            resultDiv.innerHTML = '<h2>æµ‹è¯• 2: æµ‹è¯•æ˜¾ç¤ºå‡½æ•°</h2><pre>æ­£åœ¨æµ‹è¯•...</pre>';
            
            // æ¨¡æ‹Ÿ displayBlogs å‡½æ•°
            const blogs = testData.blogs || [];
            
            if (blogs.length === 0) {
                resultDiv.innerHTML = `
                    <h2 class="error">âŒ æµ‹è¯• 2: åšå®¢æ•°ç»„ä¸ºç©º</h2>
                `;
                return;
            }
            
            let html = `
                <h2 class="success">âœ… æµ‹è¯• 2: æ˜¾ç¤ºå‡½æ•°æµ‹è¯•</h2>
                <p class="info">åšå®¢æ•°é‡: ${blogs.length}</p>
                <div style="border: 1px solid #ddd; padding: 15px; margin: 10px 0; border-radius: 4px;">
            `;
            
            blogs.forEach((blog, index) => {
                html += `
                    <div style="border-bottom: 1px solid #eee; padding: 10px 0;">
                        <h3>${index + 1}. ${blog.title || '(æ— æ ‡é¢˜)'}</h3>
                        <p><strong>ID:</strong> ${blog.id}</p>
                        <p><strong>æ—¥æœŸ:</strong> ${blog.date || '(æ— æ—¥æœŸ)'}</p>
                        <p><strong>å†…å®¹:</strong> ${blog.content?.substring(0, 100) || '(æ— å†…å®¹)'}...</p>
                    </div>
                `;
            });
            
            html += '</div>';
            html += '<p class="info">âœ… æ•°æ®æ ¼å¼æ­£ç¡®ï¼Œåº”è¯¥å¯ä»¥æ­£å¸¸æ˜¾ç¤º</p>';
            
            resultDiv.innerHTML = html;
        }
        
        async function runAll() {
            await testAPI();
            await new Promise(resolve => setTimeout(resolve, 500));
            testDisplay();
            await new Promise(resolve => setTimeout(resolve, 500));
            testElement();
        }
        
        // è‡ªåŠ¨è¿è¡Œ
        window.addEventListener('load', () => {
            setTimeout(runAll, 500);
        });
    </script>
</body>
</html>

